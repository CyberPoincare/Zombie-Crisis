# 开发日志 (Changelog)

## [1.1.0] - 2025-12-25

### 新增特性

- **高度动态的环境化对话系统**
  - **地理位置感知**: 深度整合 OpenStreetMap 数据，实时提取街道、地标、建筑名称和区域信息。
  - **基于 Gemini 的无线电通讯**: 移除固定模板。无线电对话现由 Gemini 1.5 Flash 动态生成，能根据当前街道（如：Broadway）和地标构建逼真的战场报告。
  - **情境化心声**: 角色头顶的文字气泡（Thoughts）会根据其在纽约的实际位置提到周边的道路和建筑，显著提升代入感。
- **通讯系统稳定性优化**
  - **容量翻倍**: 将日志缓存上限提升至 200 条，配合多层级唯一 ID 生成机制，彻底解决滚动时记录跳变/丢失问题。
  - **交互改进**: 增加“新消息提示”浮窗，手动翻阅历史记录时不会被强制置底，并恢复了滚动条可见性。
  - **智能限流**: 对相同来源的重复反馈（如频繁的射击/治疗报告）增加了 2 秒触发频率限制，保持频道整洁。

### 调整与优化

- **游戏地点迁移**: 默认游戏起点由成都改为 **纽约时代广场 (NYC Times Square)**。
- **项目引导**: 添加了 `.env.example` 模板并重写了 `README.md` 中的环境配置流程，方便快速部署。

## [1.0.0] - 2025-12-25

### 新增特性

- **交互式实时通讯频道**
  - 在无线电日志中点击队员姓名可立即在地图上定位并选中该单位。
  - 实现“镜头跟随”模式：点击定位后地图会锁定并跟随队员移动，保持其在视野中心。
  - 智能自动滚动：仅当玩家位于底部时才自动滚动新消息，方便阅读历史记录。
  - 窗口缩放功能：支持拖动频道窗口边缘或右上角来调整窗口大小。
- **高级语音系统**
  - 武装平民加入：平民一旦获得空投武器即可接入无线电频道并发布状态。
  - 误伤警报：增加了指挥部对友军误伤（空袭、爆炸）的语音警报。
  - 角色间吐槽：特种队员会根据周围环境对武装平民的“非专业”表现进行语音抱怨。
- **视觉效果增强**
  - 优化了射击线和医疗线的渲染逻辑，解决了镜头移动时的视觉错位问题。

### 优化与修复

- **地图交互**：增加了鼠标拖拽自动退出镜头跟随的功能，实现操作无缝切换。
- **性能优化**：改进了主循环中的实体状态同步逻辑。
- **大气音效**：增加了队员在空闲时的随机自言自语，增强战场沉浸感。

---
*注：本项目持续开发中。*
